# HealthTech Operator Dashboard

- [HealthTech Operator Dashboard](#healthtech-operator-dashboard)
  - [Other documents](#other-documents)
  - [Local Development](#local-development)
    - [Programs needed to run project](#programs-needed-to-run-project)
    - [Installation](#installation)
    - [Run locally](#run-locally)
    - [Linting and formatting](#linting-and-formatting)
    - [Testing](#testing)
    - [Build for Production](#build-for-production)
  - [Deployment](#deployment)
    - [Docker Deployment](#docker-deployment)
    - [DIY Deployment](#diy-deployment)
  - [File structure](#file-structure)

## Other documents

- [Tips for developing with VSCode (please read)](./vscode-tips.md)
- [Tech Stack](./tech-stack.md)
- [React Router README](react-router_README.md)

## Local Development

### Programs needed to run project

- [node](https://nodejs.org/en)
- [pnpm](https://pnpm.io/)

### Installation

Install the required external dependencies:

```sh
pnpm install
```

### Run locally

Run the dev server:

```sh
pnpm dev
```

### Linting and formatting

Check for linting errors and apply safe fixes:

```sh
pnpm lint
```

Check for formatting errors and apply safe fixes:

```sh
pnpm format
```

Do both in one check:

```sh
pnpm check
```

### Testing

Install required browsers for running e2e tests:

```sh
pnpm e2e:install
```

Run all tests:

```sh
pnpm e2e:test
```

Use the `ui` flag to watch the tests:

```sh
pnpm exec playwright test --ui
```

Run tests for individual browsers:

| Google Chrome | Firefox | Safari |
| --- | --- | --- |
|`pnpm e2e:test:chromium`|`pnpm e2e:test:firefox`|`pnpm e2e:test:webkit`|

Generate tests interactively:

```sh
pnpm e2e:test:generate
```

Read more in the [docs](https://playwright.dev/docs/codegen).

### Build for Production

First, build your app for production:

```sh
pnpm build
```

Then run the app in production mode:

```sh
pnpm start
```

Now you'll need to pick a host to deploy it to.

## Deployment

### Docker Deployment

To build and run using Docker:

```bash
docker build -t my-app .

# Run the container
docker run -p 3000:3000 my-app
```

The containerized application can be deployed to any platform that supports Docker, including:

- AWS ECS
- Google Cloud Run
- Azure Container Apps
- Digital Ocean App Platform
- Fly.io
- Railway

### DIY Deployment

If you're familiar with deploying Node applications, the built-in app server is production-ready.

Make sure to deploy the output of `pnpm run build`

```
├── package.json
├── package-lock.json (or pnpm-lock.yaml, or bun.lockb)
├── build/
│   ├── client/    # Static assets
│   └── server/    # Server-side code
```

## File structure

- `dashboard/`: root folder with configuration files and subfolders
  - `.github/`: GitHub config like CI/CD workflows and PR templates
  - `.react-router/`: autogenerated types from React Router
  - `.vscode/`: Local per user workspace settings for those using VSCode
  - `app/`: All source code for the web app
    - `__tests__/`: End-to-end tests for full pages or user stories
    - `components/`: Common components used in multiple pages. Encapsulates features into singular units.
      - `ui`: Primitives acting as the foundational building blocks for composing larger features or sections, for example common layout components like headers, footers and sidebars, or features like a login modal. Most primitives originates from shadcn/ui and might be manually tweaked to our preferences.
    - `hooks/`: Common React hooks reused in multiple pages
    - `lib/`: Common code reused in multiple pages
    - `routes/`: Page components rendered by our router. This includes common layouts and should try to reflect either the routing or grouping of responsibilities as close as possible. If the component uses router apis, then it should most likely lie here.
    - `app.css`: Style variables accessable throughout the whole app. Mainly configuration of Tailwind and CSS variables.
    - `root.tsx`: Root HTML rendered for ALL pages. Contains global metadata, styles and providers.
    - `routes.ts`: Routing declared through the React Router routes API. Check out the [docs](https://reactrouter.com/start/framework/routing) for an in-depth explanation of the API.
  - `build/`: Build artifacts for deploying the app to servers
  - `public/`: Assets requiring no processing, clients download these files as is.
